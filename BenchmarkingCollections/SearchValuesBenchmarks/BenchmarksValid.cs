using System.Buffers;
using System.Collections.Frozen;
using BenchmarkDotNet.Attributes;

// ReSharper disable StringLiteralTypo

namespace SearchValuesBenchmarks;

[MemoryDiagnoser()]
public class BenchmarksValid
{
    private static readonly char[] AllowedSymbolsArray = 
    {
        'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 
        'O', 'P', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z',
        '0', '1', '2', '3', '4', '5', '6', '7', '8', '9'
    };

    private static readonly HashSet<char> AllowedSymbolsHashSet = AllowedSymbolsArray.ToHashSet();

    private static readonly FrozenSet<char> AllowedSymbolsFrozenSet = AllowedSymbolsArray.ToFrozenSet();

    private static readonly SearchValues<char> AllowedSymbolsSearchValues = SearchValues.Create(AllowedSymbolsArray);

    [Params(
        "AFHB58AHBIF49GJCNSCYJKL234FZXCV",
        "AFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCV",
        "AFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCV",
        "AFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCVAFHB58AHBIF49GJCNSCYJKL234FZXCV")]
    public string ValidString = null!;
    
    
    
   
    
    

    [Benchmark]
    public bool Naive_Valid()
    {
        foreach (var ch in ValidString)
        {
            if (AllowedSymbolsArray.Contains(ch) is false)
                return false;
        }

        return true;
    }
    
    [Benchmark]
    public bool Span_Valid()
    {
        return ValidString.AsSpan().IndexOfAnyExcept(AllowedSymbolsArray) is -1;
    }
    
    
    
    [Benchmark]
    public bool HashSet_Valid()
    {
        foreach (var ch in ValidString)
        {
            if (AllowedSymbolsHashSet.Contains(ch) is false)
                return false;
        }

        return true;
    }
    
    [Benchmark]
    public bool FrozenSet_Valid()
    {
        foreach (var ch in ValidString)
        {
            if (AllowedSymbolsFrozenSet.Contains(ch) is false)
                return false;
        }

        return true;
    }
    
    [Benchmark]
    public bool SearchValues_Valid()
    {
        return ValidString.AsSpan().IndexOfAnyExcept(AllowedSymbolsSearchValues) is -1;
    }
}